@no_prelude
module integrationTests.syntax.sigils.gtkBuilder

use aivi.ui.gtk4

node : GtkNode
node =
  ~<gtk>
    <object class="GtkBox" props={{ spacing: 24, marginTop: 12 }}>
      <object class="GtkLabel">
        <property name="label">
          Hello
        </property>
      </object>
    </object>
  </gtk>

interfaceNode : GtkNode
interfaceNode =
  ~<gtk>
    <interface>
      <requires lib="gtk" version="4.0">
      </requires>
      <object class="GtkBox">
        <object class="GtkLabel" id="headline">
          <property name="label">
            Hi
          </property>
        </object>
        <object ref="headline">
        </object>
      </object>
    </interface>
  </gtk>

templateNode : GtkNode
templateNode =
  ~<gtk>
    <template class="AppCard" parent="GtkBox">
      <property name="orientation">
        vertical
      </property>
      <object class="GtkOverlay">
        <object class="GtkLabel" id="baseLabel">
          <property name="label">
            Base
          </property>
        </object>
        <child type="overlay">
          <object class="GtkLabel">
            <property name="label">
              Badge
            </property>
          </object>
        </child>
      </object>
      <object class="GtkButton">
        <property name="label">
          Open
        </property>
        <signal name="clicked" handler="onOpenClicked" swapped="no">
        </signal>
      </object>
    </template>
  </gtk>

signalSugarNode : GtkNode
signalSugarNode =
  ~<gtk>
    <object class="GtkButton" onClick={ Msg.Save }>
      <property name="label">
        Save
      </property>
      <signal name="clicked" on={ Msg.Save }>
      </signal>
    </object>
  </gtk>

// Regression: nested `~<gtk>` inside a splice must not
// cause the lexer to close the outer sigil prematurely.
nestedSigilInSplice : GtkNode
nestedSigilInSplice =
  ~<gtk>
    <object class="GtkBox">
      { ~<gtk><object class="GtkLabel" /></gtk> }
    </object>
  </gtk>
