@no_prelude
module integrationTests.syntax.patternMatching.guardsWhen

use aivi
use aivi.testing

classify =
  | n when n < 0   => "negative"
  | 0              => "zero"
  | n when n < 10  => "small"
  | n when n < 100 => "medium"
  | _              => "large"

  @test
  guardsWork = effect {
    assertEq (classify (-1)) "negative"
    assertEq (classify 0) "zero"
    assertEq (classify 42) "medium"
  }
