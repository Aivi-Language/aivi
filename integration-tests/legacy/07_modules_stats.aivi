@no_prelude
module examples.compiler.stats
export sum, mean

use examples.compiler.math
use aivi.testing
use aivi

sum =
  | []        => 0
  | [h, ...t] => add h (sum t)

sumCount =
  | []        => (0, 0)
  | [h, ...t] => (sumCount t) ?
    | (s, n)    => (h + s, n + 1)

  mean = xs => (sumCount xs) ?
    | (_, n) when n == 0 => 0
    | (s, n)             => s / n

  __test_sentinel = 0

  @test
smoke = effect {
  _ <- assert (sum [1, 2, 3] == 6)
  _ <- assert (mean [1, 2, 3, 4] == 2.5)
}
