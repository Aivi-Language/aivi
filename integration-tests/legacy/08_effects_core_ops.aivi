module examples.runtime_effects_core_ops
export main

use aivi.console
use aivi.testing


main : Effect Text Unit
main = effect {
  n <- pure 41
  m <- pure (n + 1)

  res <- attempt (if m == 42 then fail "boom" else pure m)

  verdict <- res ?
    | Ok x  => pure "ok"
    | Err e => pure "err"

    print verdict

    if m > 40 then effect {
      print "branch"
    } else pure Unit
}

__test_sentinel = 0

@test
smoke = effect {
  res <- attempt (fail "boom")
  _ <- res ?
    | Ok _  => assert False
    | Err _ => assert True
}
