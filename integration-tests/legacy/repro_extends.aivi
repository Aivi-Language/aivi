use aivi.testing
use aivi

@no_prelude
module aivi.repro_extends

class Super A = {
  foo: A -> A
}

class Sub A = Super A with {
  bar: A -> A
}

// Case 1: Checking if Sub instance requires implementing foo
// If backend merges members, this should ERROR (missing foo).
instance Sub Int = {
  bar: x => x
}

// Case 2: If we provide Super instance, does Sub still require foo?
instance Super Int = {
  foo: x => x
}

__test_sentinel = 0

@test
smoke = effect {
  _ <- assert (Super.foo 7 == 7)
  _ <- assert (Sub.bar 5 == 5)
}
