@no_prelude
module integrationTests.stdlib.aivi.matrix.tests

use aivi
use aivi.testing
use aivi.matrix

@test "mat2"
mat2_functional = do Effect {
  m = identity2
  assert (m.m00 == 1.0)
}

@test "mat3"
mat3_functional = do Effect {
  m = identity3
  assert (m.m00 == 1.0)
}

@test "mat4"
mat4_functional = do Effect {
  m = identity4
  assert (m.m00 == 1.0)
}

@test "scalar"
scalar_functional = do Effect {
  s = 1.0
  assert (s == 1.0)
}

@test "identity2"
identity2_functional = do Effect {
  assert (identity2.m00 == 1.0)
  assert (identity2.m01 == 0.0)
}

@test "identity3"
identity3_functional = do Effect {
  assert (identity3.m00 == 1.0)
  assert (identity3.m22 == 1.0)
}

@test "identity4"
identity4_functional = do Effect {
  assert (identity4.m00 == 1.0)
  assert (identity4.m33 == 1.0)
}

@test "multiply2"
multiply2_functional = do Effect {
  assert (multiply2 identity2 identity2 == identity2)
}

@test "multiply3"
multiply3_functional = do Effect {
  assert (multiply3 identity3 identity3 == identity3)
}

@test "multiply4"
multiply4_functional = do Effect {
  assert (multiply4 identity4 identity4 == identity4)
}

@test "transpose2"
transpose2_functional = do Effect {
  m = ~mat[1.0 2.0
    3.0 4.0
  ]

  t = transpose2 m
  assert (t.m01 == 3.0)
  assert (t.m10 == 2.0)
}

@test "transpose3"
transpose3_functional = do Effect {
  assert (transpose3 identity3 == identity3)
}

@test "transpose4"
transpose4_functional = do Effect {
  assert (transpose4 identity4 == identity4)
}
