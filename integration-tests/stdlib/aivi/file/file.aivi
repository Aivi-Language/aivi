@no_prelude
module integrationTests.stdlib.aivi.file.tests

use aivi
use aivi.testing
use aivi.file

fileStats_touch : FileStats -> Unit
fileStats_touch = _ => Unit

@test
fileStats_smoke = effect {
  _ <- pure fileStats_touch
  _ <- assertEq (1 + 1) 2
}

@test
close_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
delete_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
exists_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
open_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
readAll_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
readText_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
stat_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}

@test
writeText_smoke = effect {
  p = "tmp/integration-tests-file-smoke.txt"
  _   <- writeText p "hello"
  ok  <- exists p
  _   <- assert ok
  txt <- readText p
  _   <- assert (txt == "hello")
  _   <- delete p
}
