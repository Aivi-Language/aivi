@no_prelude
module integrationTests.stdlib.aivi.probability.tests

use aivi
use aivi.testing
use aivi.probability

@test "probability clamp"
probability_clamp = do Effect {
  p1 = clamp 0.5
  assert (p1 == 0.5)

  p2 = clamp 1.5
  assert (p2 == 1.0)

  p3 = clamp (-0.5)
  assert (p3 == 0.0)
}

@test "bernoulli"
bernoulli_functional = do Effect {
  dist = bernoulli 0.25
  assertEq (dist.pdf True) 0.25
  assertEq (dist.pdf False) 0.75
}

@test "uniform"
uniform_functional = do Effect {
  dist = uniform 0.0 10.0
  assertEq (dist.pdf (-1.0)) 0.0
  assertEq (dist.pdf 5.0) 0.1
  assertEq (dist.pdf 12.0) 0.0
}
