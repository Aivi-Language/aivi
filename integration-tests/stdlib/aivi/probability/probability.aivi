@no_prelude
module integrationTests.stdlib.aivi.probability.tests

use aivi
use aivi.testing
use aivi.probability

distribution_touch : Distribution -> Unit
distribution_touch = _ => Unit

@test
distribution_smoke = effect {
  pure distribution_touch
  assertEq (1 + 1) 2
}

@test
bernoulli_smoke = effect {
  d = bernoulli 0.25
  assertEq (d.pdf True) 0.25
  assertEq (d.pdf False) 0.75
}

@test
clamp_smoke = effect {
  assertEq (clamp (-0.1)) 0.0
  assertEq (clamp 0.3) 0.3
  assertEq (clamp 1.7) 1.0
}

@test
expectation_smoke = effect {
  dist = { pdf: x => if x == 2.0 then 0.5 else 0.0 }
  assertEq (expectation dist 2.0) 1.0
}

@test
uniform_smoke = effect {
  d = uniform 0.0 2.0
  assertEq (d.pdf (-1.0)) 0.0
  assertEq (d.pdf 0.0) 0.5
  assertEq (d.pdf 1.0) 0.5
  assertEq (d.pdf 2.0) 0.5
  assertEq (d.pdf 3.0) 0.0
}
