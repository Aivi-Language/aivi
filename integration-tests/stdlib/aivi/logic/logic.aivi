@no_prelude
module integrationTests.stdlib.aivi.logic.tests

use aivi
use aivi.testing

// -- Setoid (equality) --

@test "setoid int"
setoid_int = do Effect {
  assert (1 == 1)
  assert (1 != 2)
}

@test "setoid text"
setoid_text = do Effect {
  assert ("hello" == "hello")
  assert ("hello" != "world")
}

// -- Ord (ordering) --

@test "ord int"
ord_int = do Effect {
  assert (1 < 2)
  assert (2 > 1)
  assert (1 <= 1)
  assert (1 >= 1)
}

// -- Functor --

@test "functor option"
functor_option = do Effect {
  some = Some 5
  mapped = map (x => x + 1) some
  assertEq mapped (Some 6)

  noVal = None
  mappedNone = map (x => x + 1) noVal
  assertEq mappedNone None
}

@test "functor list"
functor_list = do Effect {
  xs = [1, 2, 3]
  ys = map (x => x * 2) xs
  assertEq ys [2, 4, 6]
}
