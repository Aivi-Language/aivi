@no_prelude
module integrationTests.stdlib.aivi.logic.tests

use aivi
use aivi.testing
use aivi.logic

// -- Setoid (equality) --

@test
setoid_int = do Effect {
  assert (1 == 1)
  assert (1 != 2)
}

@test
setoid_text = do Effect {
  assert ("hello" == "hello")
  assert ("hello" != "world")
}

// -- Ord (ordering) --

@test
ord_int = do Effect {
  assert (1 < 2)
  assert (2 > 1)
  assert (1 <= 1)
  assert (1 >= 1)
}

// -- Functor --

@test
functor_option = do Effect {
  some = Some 5
  mapped = map (x => x + 1) some
  assertEq mapped (Some 6)

  none : Option Int
  none = None
  mappedNone = map (x => x + 1) none
  assertEq mappedNone None
}

@test
functor_list = do Effect {
  xs = [1, 2, 3]
  ys = map (x => x * 2) xs
  assertEq ys [2, 4, 6]
}

// -- Foldable --

@test
foldable_list = do Effect {
  xs = [1, 2, 3, 4]
  total = foldl (acc x => acc + x) 0 xs
  assertEq total 10
}
