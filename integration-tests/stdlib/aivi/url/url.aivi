@no_prelude
module integrationTests.stdlib.aivi.url.tests

use aivi
use aivi.testing
use aivi.url

@test "parse"
parse_functional = do Effect {
  res = parse "https://example.com:8080/path?q=v#hash"
  r <- res match
    | Ok re => do Effect { pure re }
    | Err _ => do Effect { fail "parse failed" }
    assert (r.protocol == "https")
    assert (r.host == "example.com")
    assert (r.port == Some 8080)
}

@test "to string"
toString_functional = do Effect {
  u = { protocol: "http", host: "example.com", port: None, path: "/", query: [], hash: None }
  s = toString u
  assert (text.startsWith s "http://example.com")
}
