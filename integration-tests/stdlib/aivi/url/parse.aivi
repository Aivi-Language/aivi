@no_prelude
module integrationTests.stdlib.aivi.url.parse

use aivi
use aivi.testing (assert)

use aivi.url

subject = parse

@test
smoke = effect {
  res = parse "https://example.com:8080/path?q=v#hash"
  r <- match res with
    Ok u => pure u
    Err e => fail e
  _ <- assert (r.protocol == "https")
  _ <- assert (r.host == "example.com")
  _ <- assert (r.port == Some 8080)
}
