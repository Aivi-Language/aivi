@no_prelude
module integrationTests.stdlib.aivi.regex.Match

use aivi
use aivi.testing

use aivi.regex

Ref = Match

@test
smoke = effect {
  reResult = compile "."
  r <- reResult ? {
    | Ok re => effect { pure re }
    | Err _ => effect { fail "compile failed" }
  }
  
  mResult = regex.match r "a"
  _ <- mResult ? {
    | Some m => testing.assert (m.full == "a")
    | None => assert False
  }
}
