@no_prelude
module integrationTests.stdlib.aivi.regex.Match

use aivi
use aivi.testing (assert)

use aivi.regex

Ref = Match

@test
smoke = effect {
  r <- match compile "." {
    | Ok re => pure re
    | Err _ => fail "compile failed"
  }
  _ <- match match r "a" {
    | Some m => assert (m.full == "a") // m has type Match
    | None => assert False
  }
}
