@no_prelude
module integrationTests.stdlib.aivi.regex.findAll

use aivi
use aivi.testing (assert)

use aivi.regex

subject = findAll

@test
smoke = effect {
  r <- match compile "l" {
    | Ok re => pure re
    | Err _ => fail "compile failed"
  }
  ms = findAll r "hello"
  _ <- assert (length ms == 2)
  _ <- match ms {
    | [(s1, e1), (s2, e2)] => effect {
        _ <- assert (s1 == 2)
        _ <- assert (s2 == 3)
      }
    | _ => assert False
  }
}
