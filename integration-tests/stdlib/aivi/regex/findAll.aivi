@no_prelude
module integrationTests.stdlib.aivi.regex.findAll

use aivi
use aivi.testing
use aivi.regex

@test
smoke = effect {
  reResult = compile "l"
  r <- reResult ?
    | Ok re => pure re
    | Err _ => fail "compile failed"
    ms = findAll r "hello"
    _ <- assert (List.length ms == 2)
    _ <- ms ?
      | [(s1, _), (s2, _)] => effect {
        _ <- assertEq s1 2
        _ <- assertEq s2 3
      }
      | _ => assert False
}
