@no_prelude
module integrationTests.stdlib.aivi.regex.findAll

use aivi
use aivi.testing
use aivi.regex

@test
smoke = effect {
  reResult = compile "l"
  r <- reResult ?
    | Ok re => effect { pure re }
    | Err _ => effect { fail "compile failed" }
    ms = findAll r "hello"
    _ <- assert (length ms == 2)
    _ <- match ms {
      | [(s1, e1), (s2, e2)] => effect {
        _ <- assert (s1 == 2)
        _ <- assert (s2 == 3)
      }
      | _ => assert False
    }
}
