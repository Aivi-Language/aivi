@no_prelude
module integrationTests.stdlib.aivi.regex.match

use aivi
use aivi.testing

use aivi.regex



@test
smoke = effect {
  r <- match compile "h(e)llo" {
    | Ok re => pure re
    | Err _ => fail "compile failed"
  }
  m = match r "hello"
  _ <- match m {
    | Some res => effect {
        _ <- testing.assert (res.full == "hello")
        _ <- testing.assert (res.groups == [Some "e"])
        _ <- testing.assert (res.start == 0)
        _ <- testing.assert (res.end == 5)
      }
    | None => assert False
  }
}
