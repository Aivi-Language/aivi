@no_prelude
module integrationTests.stdlib.aivi.regex.find

use aivi
use aivi.testing (assert)

use aivi.regex

subject = find

@test
smoke = effect {
  r <- match compile "e" {
    | Ok re => pure re
    | Err _ => fail "compile failed"
  }
  _ <- match find r "hello" {
    | Some (s, e) => effect {
        _ <- assert (s == 1)
        _ <- assert (e == 2)
      }
    | None => assert False
  }
}
