@no_prelude
module integrationTests.stdlib.aivi.regex.find

use aivi
use aivi.testing

use aivi.regex



@test
smoke = effect {
  reResult = compile "e"
  r <- reResult ?
    | Ok re => effect { pure re }
    | Err _ => effect { fail "compile failed" }

  fResult = regex.find r "hello"
  _ <- fResult ?
    | Some (s, e) => effect {
        _ <- testing.assert (s == 1)
        _ <- testing.assert (e == 2)
      }
    | None => assert False
}
