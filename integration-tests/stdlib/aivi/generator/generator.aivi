@no_prelude
module integrationTests.stdlib.aivi.generator.tests

use aivi
use aivi.testing
use aivi.generator

generator_touch : Generator -> Unit
generator_touch = _ => Unit

@test
generator_smoke = effect {
  pure generator_touch
  assertEq (1 + 1) 2
}

@test
filter_smoke = effect {
  xs = toList (filter (_ % 2 == 0) (fromList [1, 2, 3, 4]))
  assert (xs == [2, 4])
}

@test
foldl_smoke = effect {
  s = foldl (acc x => acc + x) 0 (fromList [1, 2, 3])
  assert (s == 6)
}

@test
fromList_smoke = effect {
  xs = toList (fromList [1, 2, 3])
  assert (xs == [1, 2, 3])
}

@test
map_smoke = effect {
  xs = toList (map (_ + 1) (fromList [1, 2, 3]))
  assert (xs == [2, 3, 4])
}

@test
range_smoke = effect {
  xs = toList (range 1 3)
  assert (xs == [1, 2, 3])
}

@test
toList_smoke = effect {
  xs = toList (fromList [1, 2, 3])
  assert (xs == [1, 2, 3])
}
