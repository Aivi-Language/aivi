@no_prelude
module integrationTests.stdlib.aivi.console.tests

use aivi
use aivi.testing
use aivi.console

@test "error"
error_functional = do Effect {
  result <- attempt (error "err")
  result match
    | Ok unit => assertEq unit Unit
    | Err _   => assert False
}

@test "log"
log_functional = do Effect {
  result <- attempt (log "log")
  result match
    | Ok unit => assertEq unit Unit
    | Err _   => assert False
}

@test "print"
print_functional = do Effect {
  result <- attempt (print "p")
  result match
    | Ok unit => assertEq unit Unit
    | Err _   => assert False
}

@test "println"
println_functional = do Effect {
  result <- attempt (println "pl")
  result match
    | Ok unit => assertEq unit Unit
    | Err _   => assert False
}

@test "read line"
readLine_functional = do Effect {
  line <- readLine
  assertEq (line match
    | Ok _  => True
    | Err _ => False
  ) True
}

@test "strip"
strip_functional = do Effect {
  assertEq (strip "plain") "plain"
}
