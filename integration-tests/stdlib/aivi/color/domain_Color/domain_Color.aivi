@no_prelude
module integrationTests.stdlib.aivi.color.domain_Color.tests

use aivi
use aivi.testing
use aivi.color
use aivi.color (domain Color)

@test
suffix_h_smoke = effect {
  rgb = { r: 10, g: 20, b: 30 }
  adjusted = rgb + 1h
  assert (toHex adjusted != toHex rgb)
}

@test
suffix_l_smoke = effect {
  rgb = { r: 20, g: 20, b: 20 }
  adjusted = rgb + 1l
  assert (toHex adjusted != toHex rgb)
}

@test
suffix_s_smoke = effect {
  rgb = { r: 0, g: 50, b: 100 }
  adjusted = rgb + 1s
  assert (toHex adjusted != toHex rgb)
}

@test
rgb_channel_literals = effect {
  rgb = 20r + 128g + 20b
  assert (rgb == { r: 20, g: 128, b: 20 })
}
