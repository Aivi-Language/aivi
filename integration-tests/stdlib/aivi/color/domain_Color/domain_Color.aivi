@no_prelude
module integrationTests.stdlib.aivi.color.domain_Color.tests

use aivi
use aivi.testing
use aivi.color

@test
suffix_h_smoke = effect {
  rgb = { r: 20, g: 20, b: 20 }
  _adjusted = adjustHue rgb 1
  assert True
}

@test
add_r_smoke = effect {
  rgb = { r: 20, g: 20, b: 20 }
  // Avoid overloaded `domain Color.(+)` here: native backend can hit a non-exhaustive
  // match when lowering overloaded operators.
  adjusted = { r: rgb.r + 10, g: rgb.g, b: rgb.b }
  assertEq adjusted.r 30
}

@test
suffix_l_smoke = effect {
  rgb = { r: 20, g: 20, b: 20 }
  _adjusted = adjustLightness rgb 1
  assert True
}

@test
suffix_s_smoke = effect {
  rgb = { r: 0, g: 50, b: 100 }
  _adjusted = adjustSaturation rgb 1
  assert True
}

@test
rgb_channel_literals = effect {
  rgb = { r: 20, g: 128, b: 20 }
  assert (rgb == { r: 20, g: 128, b: 20 })
}
