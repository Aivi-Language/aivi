@no_prelude
module integrationTests.stdlib.aivi.net.http.tests

use aivi
use aivi.testing
use aivi.net.http

error_touch : Error -> Unit
error_touch = _ => Unit

@test
error_smoke = effect {
  _ <- pure error_touch
  _ <- assertEq (1 + 1) 2
}

header_touch : Header -> Unit
header_touch = _ => Unit

@test
header_smoke = effect {
  _ <- pure header_touch
  _ <- assertEq (1 + 1) 2
}

request_touch : Request -> Unit
request_touch = _ => Unit

@test
request_smoke = effect {
  _ <- pure request_touch
  _ <- assertEq (1 + 1) 2
}

response_touch : Response -> Unit
response_touch = _ => Unit

@test
response_smoke = effect {
  _ <- pure response_touch
  _ <- assertEq (1 + 1) 2
}

@test
fetch_smoke = effect {
  req = { method: "GET", url: "http://example.com", headers: [], body: None }
  src = fetch req
  res <- src
  _   <- assert True
}

@test
get_smoke = effect {
  // get returns a source
  src = get "http://example.com"
  // src yield a Result Response Error
  res <- src
  _   <- assert True // Just checking not crashing for now without real network
}

@test
post_smoke = effect {
  src = post "http://example.com" "body"
  res <- src
  _   <- assert True
}
