@no_prelude
module integrationTests.stdlib.aivi.i18n.bundleFromProperties

use aivi
use aivi.testing
use aivi.i18n

@test
smoke = effect {
  l_res = parseLocale "en"
  l <- l_res ?
    | Ok l  => pure l
    | Err e => fail e
    props = "greet = Hello, {name}!\nval = 123"
    b_res = bundleFromProperties l props
    b <- b_res ?
      | Ok b  => pure b
      | Err e => fail e
    _ <- assert (b.locale.language == "en")
}
