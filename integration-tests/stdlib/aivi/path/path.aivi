@no_prelude
module integrationTests.stdlib.aivi.path.tests

use aivi
use aivi.testing
use aivi.path

path_touch : Path -> Unit
path_touch = _ => Unit

@test
path_smoke = effect {
  pure path_touch
  assertEq (1 + 1) 2
}

@test
fileName_smoke = effect {
  assert (fileName (parse "/a/b/c.txt") == Some "c.txt")
}

@test
isAbsolute_smoke = effect {
  assert (isAbsolute (parse "/a"))
  assert (!(isAbsolute (parse "a")))
}

@test
normalize_smoke = effect {
  p = normalize (parse "/a/b/../c")
  assert (toString p == "/a/c")
}

@test
parent_smoke = effect {
  p = parent (parse "/a/b/c.txt")
  assert (toString p == "/a/b")
}

@test
parse_smoke = effect {
  p = parse "/a/b/c.txt"
  assert (isAbsolute p)
}

@test
toString_smoke = effect {
  p = parse "/a/b/c.txt"
  assert (toString p == "/a/b/c.txt")
}
