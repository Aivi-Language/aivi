@no_prelude
module integrationTests.stdlib.aivi.path.tests

use aivi
use aivi.testing
use aivi.path

path_touch : Path -> Unit
path_touch = _ => Unit

@test
path_smoke = effect {
  _ <- pure path_touch
  _ <- assertEq (1 + 1) 2
}

@test
fileName_smoke = effect {
  _ <- assert (fileName (parse "/a/b/c.txt") == Some "c.txt")
}

@test
isAbsolute_smoke = effect {
  _ <- assert (isAbsolute (parse "/a"))
  _ <- assert (!(isAbsolute (parse "a")))
}

@test
normalize_smoke = effect {
  p = normalize (parse "/a/b/../c")
  _ <- assert (toString p == "/a/c")
}

@test
parent_smoke = effect {
  p = parent (parse "/a/b/c.txt")
  _ <- assert (toString p == "/a/b")
}

@test
parse_smoke = effect {
  p = parse "/a/b/c.txt"
  _ <- assert (isAbsolute p)
}

@test
toString_smoke = effect {
  p = parse "/a/b/c.txt"
  _ <- assert (toString p == "/a/b/c.txt")
}
