@no_prelude
module integrationTests.stdlib.aivi.system.tests

use aivi
use aivi.testing
use aivi.system
use aivi.text

@test
args_smoke = effect {
  xs <- args
  assert (List.length xs >= 1)
  xs ?
    | []            => assert False
    | [x, ..._rest] => assert (text.isEmpty x == False)
}

@test
env_smoke = effect {
  key = "AIVI_SYSTEM_ENV_TEST"
  env.remove key
  v0 <- env.get key
  assertEq v0 None
  env.set key "ok"
  v1 <- env.get key
  assertEq v1 (Some "ok")
  env.remove key
  v2 <- env.get key
  assertEq v2 None
}

@test
exit_smoke = effect {
  pure exit
  assert True
}

@test
localeTag_smoke = effect {
  tagOpt <- localeTag
  tagOpt ?
    | None   => assert True
    | Some t => assert (text.isEmpty t == False)
}

@test
clockNow_smoke = effect {
  clock.now Unit
  assert True
}

@test
randomInt_smoke = effect {
  n <- random.int 1 10
  assert (n >= 1 && n <= 10)
}
