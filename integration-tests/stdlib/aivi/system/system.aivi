@no_prelude
module integrationTests.stdlib.aivi.system.tests

use aivi
use aivi.testing
use aivi.system
use aivi.text

@test "args"
args_functional = do Effect {
  a <- args
  assert (List.length a >= 0)
}

@test "locale tag"
localeTag_functional = do Effect {
  tag <- localeTag
  tag match
    | Some t => assert (!(text.isEmpty t))
    | None   => assert True
}

@test "env record shape"
env_record_shape = do Effect {
  result <- attempt (env.get "__AIVI_TEST_MISSING_ENV_VAR__")
  result match
    | Ok value => assertEq value None
    | Err _    => assert True
}
