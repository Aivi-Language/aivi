@no_prelude
module integrationTests.stdlib.aivi.regex

use aivi
use aivi.testing (assert)

use aivi

subject = regex

@test
smoke = effect {
  r <- match compile "h.llo" {
    | Ok re => pure re
    | Err _ => fail "compile failed"
  }
  _ <- assert (test r "hello" == True)
  _ <- assert (test r "hxllo" == True)
  _ <- assert (test r "world" == False)
  
  m = match r "hello"
  _ <- match m {
    | Some matched => assert (matched.full == "hello")
    | None => assert False
  }
}
