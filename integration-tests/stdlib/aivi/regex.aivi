@no_prelude
module integrationTests.stdlib.aivi.regex

use aivi
use aivi.testing
use aivi.regex

@test
smoke = effect {
  reResult = compile "h.llo"
  r <- reResult ?
    | Ok re => pure re
    | Err e => fail e
    _ <- assert (test r "hello" == True)
    _ <- assert (test r "hxllo" == True)
    _ <- assert (test r "world" == False)

    mResult = match r "hello"
    _ <- mResult ?
      | Some matched => assert (matched.full == "hello")
      | None         => assert False
}
