@no_prelude
module integrationTests.stdlib.aivi.regex

use aivi
use aivi.testing

use aivi

subject = regex

@test
smoke = effect {
  reResult = compile "h.llo"
  r <- reResult ?
    | Ok re => effect { pure re }
    | Err e => effect { fail e }
  _ <- testing.assert (test r "hello" == True)
  _ <- testing.assert (test r "hxllo" == True)
  _ <- testing.assert (test r "world" == False)
  
  mResult = regex.match r "hello"
  _ <- mResult ?
    | Some matched => testing.assert (matched.full == "hello")
    | None => assert False
}
