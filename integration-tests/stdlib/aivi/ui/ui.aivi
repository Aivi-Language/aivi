@no_prelude
module integrationTests.stdlib.aivi.ui.tests

use aivi
use aivi.testing
use aivi.ui

len = xs => xs ?
  | []           => 0
  | [_, ...rest] => 1 + len rest

@test
renderHtml_smoke = effect {
  node = vElement "p" [vAttr "data-x" "1"] [vText "hi"]
  html = renderHtml node
  assert (text.length html > 0)
}

@test
diff_smoke = effect {
  old = vElement "p" [vAttr "data-x" "1"] [vText "hi"]
  neu = vElement "p" [vAttr "data-x" "2"] [vText "hi"]
  ops = diff old neu
  assert (len ops >= 0)
}
