@no_prelude
module integrationTests.stdlib.aivi.ui.tests

use aivi
use aivi.testing
use aivi.ui

attr_touch : Attr -> Unit
attr_touch = _ => Unit

@test
attr_smoke = effect {
  pure attr_touch
  assertEq (1 + 1) 2
}

class_touch : Class -> Unit
class_touch = _ => Unit

@test
class_smoke = effect {
  pure class_touch
  assertEq (1 + 1) 2
}

click_touch : Click -> Unit
click_touch = _ => Unit

@test
click_smoke = effect {
  pure click_touch
  assertEq (1 + 1) 2
}

clickEvent_touch : ClickEvent -> Unit
clickEvent_touch = _ => Unit

@test
clickEvent_smoke = effect {
  pure clickEvent_touch
  assertEq (1 + 1) 2
}

element_touch : Element -> Unit
element_touch = _ => Unit

@test
element_smoke = effect {
  pure element_touch
  assertEq (1 + 1) 2
}

event_touch : Event -> Unit
event_touch = _ => Unit

@test
event_smoke = effect {
  pure event_touch
  assertEq (1 + 1) 2
}

id_touch : Id -> Unit
id_touch = _ => Unit

@test
id_smoke = effect {
  pure id_touch
  assertEq (1 + 1) 2
}

input_touch : Input -> Unit
input_touch = _ => Unit

@test
input_smoke = effect {
  pure input_touch
  assertEq (1 + 1) 2
}

inputEvent_touch : InputEvent -> Unit
inputEvent_touch = _ => Unit

@test
inputEvent_smoke = effect {
  pure inputEvent_touch
  assertEq (1 + 1) 2
}

keyboardEvent_touch : KeyboardEvent -> Unit
keyboardEvent_touch = _ => Unit

@test
keyboardEvent_smoke = effect {
  pure keyboardEvent_touch
  assertEq (1 + 1) 2
}

keyed_touch : Keyed -> Unit
keyed_touch = _ => Unit

@test
keyed_smoke = effect {
  pure keyed_touch
  assertEq (1 + 1) 2
}

liveConfig_touch : LiveConfig -> Unit
liveConfig_touch = _ => Unit

@test
liveConfig_smoke = effect {
  pure liveConfig_touch
  assertEq (1 + 1) 2
}

liveError_touch : LiveError -> Unit
liveError_touch = _ => Unit

@test
liveError_smoke = effect {
  pure liveError_touch
  assertEq (1 + 1) 2
}

onBlur_touch : OnBlur -> Unit
onBlur_touch = _ => Unit

@test
onBlur_smoke = effect {
  pure onBlur_touch
  assertEq (1 + 1) 2
}

onClick_touch : OnClick -> Unit
onClick_touch = _ => Unit

@test
onClick_smoke = effect {
  pure onClick_touch
  assertEq (1 + 1) 2
}

onClickE_touch : OnClickE -> Unit
onClickE_touch = _ => Unit

@test
onClickE_smoke = effect {
  pure onClickE_touch
  assertEq (1 + 1) 2
}

onFocus_touch : OnFocus -> Unit
onFocus_touch = _ => Unit

@test
onFocus_smoke = effect {
  pure onFocus_touch
  assertEq (1 + 1) 2
}

onInput_touch : OnInput -> Unit
onInput_touch = _ => Unit

@test
onInput_smoke = effect {
  pure onInput_touch
  assertEq (1 + 1) 2
}

onInputE_touch : OnInputE -> Unit
onInputE_touch = _ => Unit

@test
onInputE_smoke = effect {
  pure onInputE_touch
  assertEq (1 + 1) 2
}

onKeyDown_touch : OnKeyDown -> Unit
onKeyDown_touch = _ => Unit

@test
onKeyDown_smoke = effect {
  pure onKeyDown_touch
  assertEq (1 + 1) 2
}

onKeyUp_touch : OnKeyUp -> Unit
onKeyUp_touch = _ => Unit

@test
onKeyUp_smoke = effect {
  pure onKeyUp_touch
  assertEq (1 + 1) 2
}

onPointerDown_touch : OnPointerDown -> Unit
onPointerDown_touch = _ => Unit

@test
onPointerDown_smoke = effect {
  pure onPointerDown_touch
  assertEq (1 + 1) 2
}

onPointerMove_touch : OnPointerMove -> Unit
onPointerMove_touch = _ => Unit

@test
onPointerMove_smoke = effect {
  pure onPointerMove_touch
  assertEq (1 + 1) 2
}

onPointerUp_touch : OnPointerUp -> Unit
onPointerUp_touch = _ => Unit

@test
onPointerUp_smoke = effect {
  pure onPointerUp_touch
  assertEq (1 + 1) 2
}

patchOp_touch : PatchOp -> Unit
patchOp_touch = _ => Unit

@test
patchOp_smoke = effect {
  pure patchOp_touch
  assertEq (1 + 1) 2
}

pointerEvent_touch : PointerEvent -> Unit
pointerEvent_touch = _ => Unit

@test
pointerEvent_smoke = effect {
  pure pointerEvent_touch
  assertEq (1 + 1) 2
}

removeAttr_touch : RemoveAttr -> Unit
removeAttr_touch = _ => Unit

@test
removeAttr_smoke = effect {
  pure removeAttr_touch
  assertEq (1 + 1) 2
}

replace_touch : Replace -> Unit
replace_touch = _ => Unit

@test
replace_smoke = effect {
  pure replace_touch
  assertEq (1 + 1) 2
}

setAttr_touch : SetAttr -> Unit
setAttr_touch = _ => Unit

@test
setAttr_smoke = effect {
  pure setAttr_touch
  assertEq (1 + 1) 2
}

setText_touch : SetText -> Unit
setText_touch = _ => Unit

@test
setText_smoke = effect {
  pure setText_touch
  assertEq (1 + 1) 2
}

style_touch : Style -> Unit
style_touch = _ => Unit

@test
style_smoke = effect {
  pure style_touch
  assertEq (1 + 1) 2
}

textNode_touch : TextNode -> Unit
textNode_touch = _ => Unit

@test
textNode_smoke = effect {
  pure textNode_touch
  assertEq (1 + 1) 2
}

vNode_touch : VNode -> Unit
vNode_touch = _ => Unit

@test
vNode_smoke = effect {
  pure vNode_touch
  assertEq (1 + 1) 2
}

@test
diff_smoke = effect {
  old = vText "a"
  new = vText "b"
  ops = diff old new
  // SetText "root" "b"
  assert (List.length ops == 1)
}

@test
eventFromJson_smoke = effect {
  // Unknown JSON details; just ensure decoder accepts something simple.
  ev = eventFromJson "{}"
  ev ?
    | Ok _ => assert False
    | Err _ => assert True
}

@test
live_smoke = effect {
  pure live
  assert True
}

@test
patchToJson_smoke = effect {
  ops = diff (vText "a") (vText "b")
  json = patchToJson ops
  assert (Text.length json > 0)
}

@test
renderHtml_smoke = effect {
  node = vElement "p" [][vText "hi"]
  html = renderHtml node
  assert (html == "<p data-aivi-node=\"root\"><span data-aivi-node=\"root/0\">hi</span></p>")
}

@test
vAttr_smoke = effect {
  attr = vAttr "id" "foo"
  node = vElement "div" [attr] []
  assert (renderHtml node == "<div data-aivi-node=\"root\" id=\"foo\"></div>")
}

@test
vClass_smoke = effect {
  attr = vClass "c"
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vElement_smoke = effect {
  node = vElement "div" [] []
  assert (renderHtml node == "<div data-aivi-node=\"root\"></div>")
}

@test
vId_smoke = effect {
  attr = vId "x"
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vKeyed_smoke = effect {
  node = vKeyed "k" (vText "x")
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnBlur_smoke = effect {
  attr = vOnBlur "evt"
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnClick_smoke = effect {
  attr = vOnClick "evt"
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnClickE_smoke = effect {
  attr = vOnClickE (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnFocus_smoke = effect {
  attr = vOnFocus "evt"
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnInput_smoke = effect {
  attr = vOnInput (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnInputE_smoke = effect {
  attr = vOnInputE (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnKeyDown_smoke = effect {
  attr = vOnKeyDown (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnKeyUp_smoke = effect {
  attr = vOnKeyUp (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnPointerDown_smoke = effect {
  attr = vOnPointerDown (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnPointerMove_smoke = effect {
  attr = vOnPointerMove (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vOnPointerUp_smoke = effect {
  attr = vOnPointerUp (_ => "evt")
  node = vElement "div" [attr] []
  assert (Text.length (renderHtml node) > 0)
}

@test
vStyle_smoke = effect {
  style = vStyle { color: "red" }
  node = vElement "div" [style] []
  assert (renderHtml node == "<div data-aivi-node=\"root\" style=\"color: red\"></div>")
}

@test
vText_smoke = effect {
  node = vText "hello"
  assert (renderHtml node == "<span data-aivi-node=\"root\">hello</span>")
}
