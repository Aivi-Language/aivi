@no_prelude
module integrationTests.stdlib.aivi.collections.Deque

use aivi
use aivi.testing

use aivi.collections

Ref = Deque

@test
smoke = effect {
  d0 = Deque.empty
  d1 = Deque.pushBack d0 1
  d2 = Deque.pushFront d1 0

  _ <- testing.assert (Deque.peekFront d2 == Some 0)
  _ <- testing.assert (Deque.peekBack d2 == Some 1)

  res = Deque.popFront d2
  _ <- match res with
    | Some (val, d3) => effect {
      _ <- testing.assert (val == 0)
      _ <- testing.assert (Deque.peekFront d3 == Some 1)
    }
    | None => assert False
}
