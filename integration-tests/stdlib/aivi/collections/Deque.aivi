@no_prelude
module integrationTests.stdlib.aivi.collections.Deque

use aivi
use aivi.testing (assert)

use aivi.collections

Ref = Deque

@test
smoke = effect {
  d0 = Deque.empty
  d1 = Deque.pushBack d0 1
  d2 = Deque.pushFront d1 0
  
  _ <- assert (Deque.peekFront d2 == Some 0)
  _ <- assert (Deque.peekBack d2 == Some 1)
  
  res = Deque.popFront d2
  _ <- match res {
    | Some (val, d3) => do {
      _ <- assert (val == 0)
      _ <- assert (Deque.peekFront d3 == Some 1)
      pure Unit
    }
    | None => assert False
  }
}
