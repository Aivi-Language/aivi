@no_prelude
module integrationTests.stdlib.aivi.collections.Heap

use aivi
use aivi.testing (assert)

use aivi.collections

Ref = Heap

@test
smoke = effect {
  h0 = Heap.empty
  h1 = Heap.push h0 3
  h2 = Heap.push h1 1
  h3 = Heap.push h2 2
  
  _ <- assert (Heap.peekMin h3 == Some 1)
  
  res = Heap.popMin h3
  _ <- match res {
    | Some (val, h4) => do {
      _ <- assert (val == 1)
      _ <- assert (Heap.peekMin h4 == Some 2)
      pure Unit
    }
    | None => assert False
  }
}
