@no_prelude
module integrationTests.stdlib.aivi.collections.Queue

use aivi
use aivi.testing

use aivi.collections

Ref = Queue

@test
smoke = effect {
  q0 = Queue.empty
  q1 = Queue.enqueue q0 1
  q2 = Queue.enqueue q1 2

  _ <- testing.assert (Queue.peek q2 == Some 1)

  res = Queue.dequeue q2
  _ <- match res with
    | Some (val, q3) => effect {
      _ <- testing.assert (val == 1)
      _ <- testing.assert (Queue.peek q3 == Some 2)
    }
    | None => assert False
}
