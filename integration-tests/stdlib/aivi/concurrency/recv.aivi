@no_prelude
module integrationTests.stdlib.aivi.concurrency.recv

use aivi
use aivi.testing
use aivi.concurrency

@test
smoke = effect {
  (tx, rx) <- make Text
  _ <- send tx "hi"
  res <- recv rx
  _ <- res ?
    | Ok msg  => assert (msg == "hi")
    | Err _   => assert False
  _ <- close tx
}
