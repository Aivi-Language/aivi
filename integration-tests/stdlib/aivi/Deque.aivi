@no_prelude
module integrationTests.stdlib.aivi.Deque

use aivi
use aivi.testing
use aivi

@test
dequeOps = effect {
  d0 = Deque.empty
  d1 = Deque.pushBack d0 1
  d2 = Deque.pushFront d1 0

  assert (Deque.peekFront d2 == Some 0)
  assert (Deque.peekBack d2 == Some 1)

  res = Deque.popFront d2
  res ?
    | Some (val, d3) => effect {
      assertEq val 0
      assert (Deque.peekFront d3 == Some 1)
    }
    | None => assert False
}
