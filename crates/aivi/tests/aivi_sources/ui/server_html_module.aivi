module tests.ui.server_html_module
export main

use aivi.testing (assert)
use aivi.ui (TextNode)
use aivi.ui.ServerHtml

Msg = Clicked Int | Noop

main : Effect Text Unit
main = effect {
  app =
    { init: _ => 0
    , update: _ model => (model, [])
    , view: _ =>
        ~<html>
          <button onClickE={ ce => Clicked ce.button } onKeyDown={ _ => Noop }>
            { TextNode "ok" }
          </button>
        </html>
    , onPlatform: _ => None
    }

  req =
    { method: "GET"
    , path: "/"
    , headers: [ { name: "host", value: "example.test" } ]
    , body: []
    , remoteAddr: None
    }

  resp = serveHttp app req
  _ <- assert (resp.status == 200)
  pure Unit
}
